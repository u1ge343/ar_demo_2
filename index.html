<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AR Menu Experience</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- AFRAME -->
<script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

<!-- AR.JS -->
<script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>

<!-- REQUIRED FOR ANIMATION-MIXER -->
<script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

<style>
body{
 margin:0;
 font-family:Inter,sans-serif;
 background:black;
 overflow:hidden;
}

#loader{
 position:fixed;
 inset:0;
 background:rgba(0,0,0,.85);
 display:flex;
 align-items:center;
 justify-content:center;
 color:white;
 font-size:18px;
 z-index:20;
 display:none;
}

#menuOverlay{
 position:fixed;
 inset:0;
 background:rgba(0,0,0,.6);
 backdrop-filter:blur(18px);
 display:flex;
 align-items:center;
 justify-content:center;
 z-index:10;
}

.menuBox{
 width:min(92%,420px);
 background:#1e1e1e;
 padding:30px;
 border-radius:22px;
}

.menuCard{
 padding:18px;
 background:#2a2a2a;
 border-radius:14px;
 margin-bottom:14px;
 cursor:pointer;
}

.dishName{color:white;font-size:18px}
.dishDesc{color:#ccc;font-size:13px}
.price{color:#ffd36b}

#bottomBar{
 position:fixed;
 bottom:20px;
 left:50%;
 transform:translateX(-50%);
 background:#000000aa;
 padding:14px 18px;
 border-radius:18px;
 display:flex;
 gap:14px;
 color:white;
 z-index:5;
}

.btn{
 padding:6px 14px;
 background:#333;
 border-radius:8px;
 cursor:pointer;
}
</style>
</head>

<body>

<div id="loader">Loading 3D Model...</div>

<!-- MENU -->
<div id="menuOverlay">
 <div class="menuBox">

  <div class="menuCard" onclick="selectDish(0)">
   <div class="dishName">Pomodoro Pasta</div>
   <div class="dishDesc">Slow tomato sauce, basil</div>
   <div class="price">₹299</div>
  </div>

  <div class="menuCard" onclick="selectDish(1)">
   <div class="dishName">Capybara Piccata</div>
   <div class="dishDesc">Lemon butter garlic sauce</div>
   <div class="price">₹399</div>
  </div>

 </div>
</div>

<!-- CONTROLS -->
<div id="bottomBar" style="display:none;">
 <div class="btn" onclick="prevDish()">◀</div>
 <div id="dishLabel">Dish</div>
 <div class="btn" onclick="nextDish()">▶</div>
</div>

<!-- AR -->
<a-scene embedded arjs="sourceType:webcam;debugUIEnabled:false">

<a-assets>
 <a-asset-item id="pastaModel"
  src="https://raw.githubusercontent.com/u1ge343/RES_AR/refs/heads/main/assets/a.glb"></a-asset-item>

 <a-asset-item id="capyModel"
  src="assets/jb.glb"></a-asset-item>
</a-assets>

<!-- LIGHT -->
<a-entity light="type:ambient;intensity:0.6"></a-entity>
<a-entity light="type:directional;intensity:1" position="0 3 2"></a-entity>

<a-marker preset="hiro">

 <!-- SHADOW -->
 <a-plane rotation="-90 0 0" width="3" height="3"
  material="color:#000;opacity:0.35"></a-plane>

 <!-- PASTA (ROTATES) -->
 <a-entity id="pastaHolder"
  position="0 0.6 0"
  animation="property:rotation;to:0 360 0;loop:true;dur:15000">

  <a-entity id="pasta"
   gltf-model="#pastaModel"
   scale="8 8 8"
   visible="false"></a-entity>

 </a-entity>

 <!-- CAPY (ANIMATES, NO ROTATION) -->
 <a-entity id="capyHolder" position="0 0.6 0">

  <a-entity id="capy"
   gltf-model="#capyModel"
   animation-mixer="clip:*; loop:repeat"
   scale="5 5 5"
   visible="false"></a-entity>

 </a-entity>

</a-marker>

<a-entity camera></a-entity>
</a-scene>

<script>
const dishes=[
 {name:"Pomodoro Pasta", id:"pasta"},
 {name:"Capybara Piccata", id:"capy"}
];

let currentIndex=0;

const overlay=document.getElementById("menuOverlay");
const loader=document.getElementById("loader");
const bottomBar=document.getElementById("bottomBar");
const dishLabel=document.getElementById("dishLabel");

function hideAll(){
 document.getElementById("pasta").setAttribute("visible","false");
 document.getElementById("capy").setAttribute("visible","false");
}

function showDish(i){
 loader.style.display="flex";
 hideAll();
 currentIndex=i;

 const model=document.getElementById(dishes[i].id);

 model.addEventListener("model-loaded", ()=>{
   loader.style.display="none";

   if(model.hasAttribute("animation-mixer")){
     model.components["animation-mixer"].play();
   }
 },{once:true});

 model.setAttribute("visible","true");
 dishLabel.textContent=dishes[i].name;
}

function selectDish(i){
 overlay.style.display="none";
 bottomBar.style.display="flex";
 showDish(i);
}

function prevDish(){
 let i=currentIndex-1;
 if(i<0) i=dishes.length-1;
 showDish(i);
}

function nextDish(){
 let i=currentIndex+1;
 if(i>=dishes.length) i=0;
 showDish(i);
}
</script>

</body>
</html>
