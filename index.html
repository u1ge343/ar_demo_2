<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AR Menu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- A-Frame -->
<script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>

<!-- AR.js -->
<script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>

<!-- Animation mixer -->
<script src="https://cdn.jsdelivr.net/npm/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>

<!-- 3D Text Geometry -->
<script src="https://cdn.jsdelivr.net/npm/aframe-text-geometry-component@0.5.1/dist/aframe-text-geometry-component.min.js"></script>

<style>
body{
 margin:0;
 background:black;
 overflow:hidden;
 font-family:sans-serif;
}

/* LOADER */
#loader{
 position:fixed;
 inset:0;
 background:rgba(0,0,0,.85);
 display:none;
 align-items:center;
 justify-content:center;
 color:white;
 z-index:20;
}

/* MENU */
#menuOverlay{
 position:fixed;
 inset:0;
 background:rgba(0,0,0,.6);
 backdrop-filter:blur(18px);
 display:flex;
 align-items:center;
 justify-content:center;
 z-index:10;
}

.menuBox{
 width:90%;
 max-width:420px;
 background:#1a1a1a;
 padding:30px;
 border-radius:22px;
}

.menuCard{
 padding:18px;
 background:#2a2a2a;
 border-radius:14px;
 margin-bottom:14px;
 cursor:pointer;
}

.dishName{color:white;font-size:17px}
.dishDesc{color:#ccc;font-size:13px}
.price{color:#e6c46f}

/* NAV */
#bottomBar{
 position:fixed;
 bottom:20px;
 left:50%;
 transform:translateX(-50%);
 background:#000000aa;
 padding:14px 24px;
 border-radius:20px;
 display:none;
 gap:22px;
 color:white;
 z-index:5;
}

.navBtn{
 font-size:22px;
 cursor:pointer;
}
</style>
</head>

<body>

<div id="loader">Loading model...</div>

<!-- MENU -->
<div id="menuOverlay">
 <div class="menuBox">

  <div class="menuCard" onclick="selectDish(0)">
   <div class="dishName">Pomodoro Pasta</div>
   <div class="dishDesc">Slow tomato sauce, basil</div>
   <div class="price">₹299</div>
  </div>

  <div class="menuCard" onclick="selectDish(1)">
   <div class="dishName">Capybara Piccata</div>
   <div class="dishDesc">Lemon butter garlic sauce</div>
   <div class="price">₹399</div>
  </div>

 </div>
</div>

<!-- NAV -->
<div id="bottomBar">
 <div class="navBtn" onclick="prevDish()">‹</div>
 <div class="navBtn" onclick="nextDish()">›</div>
</div>

<!-- AR SCENE -->
<a-scene embedded arjs="sourceType:webcam;debugUIEnabled:false">

<a-assets>
 <a-asset-item id="pastaModel" src="assets/a.glb"></a-asset-item>
 <a-asset-item id="capyModel" src="assets/jb.glb"></a-asset-item>
</a-assets>

<!-- LIGHT -->
<a-entity light="type:ambient;intensity:0.7"></a-entity>
<a-entity light="type:directional;intensity:1.2" position="0 3 2"></a-entity>

<a-marker preset="hiro">

<!-- SHADOW -->
<a-plane rotation="-90 0 0"
 width="3.2" height="3.2"
 material="color:#000;opacity:0.35"></a-plane>

<!-- 3D TEXT -->
<a-entity id="textGroup" position="0 2.5 0" look-at="[camera]">

 <a-entity id="titleText"
  text-geometry="value: ; font:https://cdn.jsdelivr.net/npm/three/examples/fonts/helvetiker_bold.typeface.json; size:0.24; height:0.04"
  material="color:#ffffff"
  position="-1.4 0.3 0"></a-entity>

 <a-entity id="descText"
  text-geometry="value: ; font:https://cdn.jsdelivr.net/npm/three/examples/fonts/helvetiker_regular.typeface.json; size:0.13; height:0.03"
  material="color:#cccccc"
  position="-1.4 0.05 0"></a-entity>

 <a-entity id="priceText"
  text-geometry="value: ; font:https://cdn.jsdelivr.net/npm/three/examples/fonts/helvetiker_bold.typeface.json; size:0.15; height:0.04"
  material="color:#e6c46f"
  position="-1.4 -0.25 0"></a-entity>

</a-entity>

<!-- ADD TO CART BUTTON -->
<a-entity id="addBtn"
 position="0 0.4 0"
 look-at="[camera]"
 geometry="primitive:plane;width:1.4;height:0.4"
 material="color:#1f1f1f"
 class="clickable">

 <a-entity
  text="value:Add to Cart;align:center;color:#ffffff;width:3"
  position="0 0 0.01"></a-entity>

</a-entity>

<!-- PASTA -->
<a-entity position="0 0.9 0">
 <a-entity id="pasta"
  gltf-model="#pastaModel"
  animation-mixer="clip:*;loop:repeat"
  scale="5 5 5"
  visible="false"></a-entity>
</a-entity>

<!-- CAPYBARA -->
<a-entity position="0 0.9 0">
 <a-entity id="capy"
  gltf-model="#capyModel"
  animation-mixer="clip:*;loop:repeat"
  rotation="0 90 0"
  scale="5 5 5"
  visible="false"></a-entity>
</a-entity>
</a-entity>

</a-marker>

<a-entity camera></a-entity>
</a-scene>

<script>
const dishes=[
 {name:"Pomodoro Pasta",desc:"Slow tomato sauce, basil",price:"₹299",id:"pasta"},
 {name:"Capybara Piccata",desc:"Lemon butter garlic sauce",price:"₹399",id:"capy"}
];

let currentIndex=0;
let cart=[];

const overlay=document.getElementById("menuOverlay");
const loader=document.getElementById("loader");
const bottomBar=document.getElementById("bottomBar");

const titleText=document.getElementById("titleText");
const descText=document.getElementById("descText");
const priceText=document.getElementById("priceText");

const addBtn=document.getElementById("addBtn");

function hideAll(){
 document.getElementById("pasta").setAttribute("visible","false");
 document.getElementById("capy").setAttribute("visible","false");
}

function update3DText(i){
 titleText.setAttribute("text-geometry","value:"+dishes[i].name);
 descText.setAttribute("text-geometry","value:"+dishes[i].desc);
 priceText.setAttribute("text-geometry","value:"+dishes[i].price);
}

function showDish(i){
 loader.style.display="flex";
 hideAll();
 currentIndex=i;

 const model=document.getElementById(dishes[i].id);

 model.addEventListener("model-loaded",()=>{
   loader.style.display="none";
   if(model.hasAttribute("animation-mixer")){
     model.components["animation-mixer"].play();
   }
 },{once:true});

 model.setAttribute("visible","true");
 update3DText(i);
}

function selectDish(i){
 overlay.style.display="none";
 bottomBar.style.display="flex";
 showDish(i);
}

function prevDish(){
 let i=currentIndex-1;
 if(i<0) i=dishes.length-1;
 showDish(i);
}

function nextDish(){
 let i=currentIndex+1;
 if(i>=dishes.length) i=0;
 showDish(i);
}

/* ADD TO CART */
addBtn.addEventListener("click",()=>{
 cart.push(dishes[currentIndex]);
 alert(dishes[currentIndex].name+" added to cart");
});
</script>

</body>
</html>
